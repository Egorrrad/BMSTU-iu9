\documentclass[a4paper, 14pt]{extarticle}

\input{preamble}


%--------------------------------------

%--------------------------------------
%			НАЧАЛО ДОКУМЕНТА
%--------------------------------------

\begin{document}

\input{title}

\renewcommand{\ttdefault}{pcr}

\setlength{\tabcolsep}{3pt}


% Содержание:
%\tableofcontents
%\newpage

\newpage
\setcounter{page}{2}



\section{Постановка задачи}

\textbf{Дано:} Интеграл $I$

\[
\int_{a}^{b} f(x)dx
\]

где $f(x)$ -- подынтегральная функция, непрерывная на отрезке $[a, b]$.

\textbf{Найти:} Значение интеграла

\[
I^* \approx I
\]

При заданной точности $\varepsilon < 0.001$.

\textbf{Индивидуальный вариант (№4):} \( y = f(x) \) задана функцией: \( y = 2x * \cos(\frac{x}{2}) \) на отрезке \([0, \pi]\).

\[
\int_{0}^{\pi} 2x * \cos(\frac{x}{2})dx = 4.5663706
\]

\section{Основные теоретические сведения}

\subsection{Метод центральных прямоугольников}
Метод заключается в вычислении площади под графиком подынтегральной функции 
с помощью суммирования площадей прямоугольников. Ширина прямоугольника определяется 
шагом разбиения, то есть расстоянием между узлами интегрирования, высота определяется значением 
подынтегральной функции в узле интегрирования.

Пусть требуется определить значение интеграла функции $f(x)$ на отрезке $[a, b]$. 
Тогда отрезок разбивается на $n$ равных отрезков длиной $h = \frac{b-a}{n}$. 
Получаем разбиение данного отрезка точками:

\[
x_{i-0.5} = a + (i - 0.5)h \quad i = \overline{1,n}
\]

Тогда приближенное значение интеграла на всем отрезке будет равно:

\[
I^* = h \sum_{i=1}^{n} f(x_{i-0.5}) = h \sum_{i=1}^{n} f(a + (i - 0.5)h)
\]

Абсолютная погрешность приближения, полученного методом центральных прямоугольников, оценивается с помощью формулы
\[
O(h^2) \leq \frac{(b-a) \cdot M_2}{24},
\]
где
\[
M_2 = \max_{x \in [a,b]} |f''(x)|.
\]

\subsection{Метод трапеций}
Метод заключается в вычислении площади под графиком подынтегральной функции 
с помощью суммирования площадей трапеций. Высота трапеции определяется шагом 
разбиения, то есть расстоянием между узлами интегрирования, основания трапеции определяются значениями
подынтегральной функции в узлах интегрирования.

Пусть требуется определить значение интеграла функции $f(x)$ на отрезке $[a, b]$. 
Тогда отрезок разбивается на $n$ равных отрезков длиной $h = \frac{b-a}{n}$. 
Получаем разбиение данного отрезка точками:

\[
x_i = a + ih \quad i = \overline{1,n}
\]

Тогда приближенное значение интеграла на всем отрезке будет равно:

\begin{multline*}
I^* = h \left( \frac{f(a) + f(x_1)}{2} + \frac{f(x_1) + f(x_2)}{2} + \cdots \right. \\
\left. + \frac{f(x_{n-1}) + f(b)}{2} \right) = h \left( \frac{f(a) + f(b)}{2} + \sum_{i=1}^{n-1} f(x_i) \right)
\end{multline*}

Абсолютная погрешность приближения, полученного методом трапеций, оценивается с помощью формулы
\[
O(h^2) \leq \frac{(b-a) \cdot M_2}{12},
\]
где
\[
M_2 = \max_{x \in [a,b]} |f''(x)|.
\]

\subsection{Метод Симпсона}
Метод заключается в приближении функции на отрезке $[a, b]$ интерполяционным 
многочленом второй степени функции $P_2(x)$:

\[
P_2(x) = f_{i-0.5} + \frac{f_i - f_{i-1}}{h} (x_i - x_{i-0.5}) + \frac{f_i - 2f_{i-0.5} + f_{i-1}}{h^2/2} (x_i - x_{i-0.5})^2
\]

Тогда приближенное значение интеграла на всем отрезке будет равно:

\[
I^* = \frac{h}{6} \left( f(a) + f(b) + 4 \sum_{i=1}^{n} f(x_{i-0.5}) + 2 \sum_{i=1}^{n-1} f(x_i) \right)
\]

Абсолютная погрешность приближения, полученного методом Симпсона, оценивается с помощью формулы
\[
O(h^4) \leq \frac{(b-a) \cdot M_4}{2880},
\]
где
\[
M_4 = \max_{x \in [a,b]} |f^{IV}(x)|.
\]

\subsection{Уточнение значения интеграла по Ричардсону}


$I \approx I_h^* + O(h^k)$,  где  $k$ - порядок точности метода, 
$I_h^*$ - приближенное значение интеграла, вычисленного с помощью метода с шагом  $h$.


Для метода средних прямоугольников и метода трапеций $k = 2$.

Для метода Симпсона $k = 4$.

\[
O(h^k) \approx ch^k, \text{ где } c - \text{некоторая константа}, h - \text{шаг}.
\]

Будем считать, что вычисления проводятся без вычислительной погрешности, тогда можно 
записать строгое равенство $I = I_h^* + ch^k$ для шага $h$

\[
I = I_h^* + c \left( \frac{h}{2} \right)^k \text{ для шага } \frac{h}{2}
\]

Из равенств можно получить уточненное значение интеграла:

\[
I = I_h^* + \frac{I_{h/2}^* - I_{h}^*}{2^k - 1}
\]

Где значение $R$ -- уточнение по Ричардсону:

\[
R = \frac{I_{h/2}^* - I_{h}^*}{2^k - 1}
\]

Данная величина используется для компенсации методологической погрешности 
численных методов интегрирования. Для построения процедуры приближенного 
вычисления интеграла с заданной точностью $\varepsilon$, используется правило Рунге:

\[
|R| < \varepsilon
\]


\section{Реализация}

\lstinputlisting[language=go, caption=Методы вычисления определенного интеграла]{code/lab2.go}


\section{Результаты}
Для заданной функции $f(x)$ были вычислены приближенные значения определенных интегралов с помощью различных методов.
Также для каждого метода было вычислено уточнение значения интеграла по Ричардсону. Результаты работы программы представлены в таблице \ref{tab:integration_methods}.

\begin{table}[h]
    \centering
    \caption{Сравнение методов численного интегрирования}
    \label{tab:integration_methods}
    \begin{tabular*}{\textwidth}{@{\extracolsep{\fill}}lccc@{}}
    \toprule
    Параметр & \multicolumn{1}{c}{Прямоугольники} & \multicolumn{1}{c}{Трапеции} & \multicolumn{1}{c}{Симпсон} \\
    \midrule
    Число разбиений, $n$ & 32 & 64 & 4 \\
    Значение интеграла, $I(n)$ & 4,\!56844 & 4,\!56534 & 4,\!57133 \\
    Погрешность, $R$ & 0,\!000516 & 0,\!000258 & 0,\!000310 \\
    Уточненное значение, $I(n)+R$ & 4,\!56895 & 4,\!56560 & 4,\!57164 \\
    \bottomrule
    \end{tabular*}
\end{table}

\section{Вывод}


По итогам лабораторной работы можно сделать следующие выводы:

\begin{itemize}
\item Метод Симпсона продемонстрировал наибольшую эффективность, достигая требуемой точности при минимальном количестве разбиений благодаря высокому порядку сходимости
    
\item Методы прямоугольников и трапеций показали сопоставимую точность, но потребовали значительно большего числа разбиений для её достижения
    
\item Применение уточнения по Ричардсону позволило повысить точность вычислений для всех рассматриваемых методов
\end{itemize}

Таким образом, для интегрирования гладких функций наиболее предпочтительным является метод Симпсона, как обеспечивающий оптимальное сочетание точности и вычислительной эффективности. 
Полученные результаты подтверждают теоретические положения о скорости сходимости различных методов численного интегрирования.


\end{document}