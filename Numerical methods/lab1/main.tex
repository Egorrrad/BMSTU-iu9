\documentclass[a4paper, 14pt]{extarticle}

\input{preamble}


%--------------------------------------

%--------------------------------------
%			НАЧАЛО ДОКУМЕНТА
%--------------------------------------

\begin{document}

\input{title}

\renewcommand{\ttdefault}{pcr}

\setlength{\tabcolsep}{3pt}


% Содержание:
%\tableofcontents
%\newpage

\newpage
\setcounter{page}{2}



\section{Постановка задачи}

Дано: функция \( y = f(x) \) задана конечным набором точек  
\[
y_i = f(x_i), \quad i = \overline{0, n} \text{ на отрезке } [a, b], \, a = x_0, \quad b = x_n, \quad x_i = a + ih, \, h = \frac{(b-a)}{n}
\]

\begin{table}[h!]
\centering
\begin{tabular}{|c|c|c|c|c|c|}
\hline
\( x_i \) & \( x_0 \) & \( x_1 \) & \dots & \( x_{n-1} \) & \( x_n \) \\ \hline
\( y_i \) & \( y_0 \) & \( y_1 \) & \dots & \( y_{n-1} \) & \( y_n \) \\ \hline
\end{tabular}
\end{table}

Найти: интерполяционную функцию \( y = g(x) \): \( g(x_i) = f(x_i), \quad i = \overline{0, n} \) (т.е. функцию, совпадающую со значениями \( y_i = f(x_i), \quad i = \overline{0, n} \) в узлах интерполяции \( x_i, \quad i = \overline{0, n} \)):

\begin{enumerate}
    \item Протабулировать функцию \( f(x) \) на отрезке \([a, b]\) с шагом \(h = \frac{(b-a)}{32} \) и распечатать таблицу \((x_i, y_i)\), \(i = \overline{0, n} \).
    \item Для заданных узлов \((x_i, y_i)\) построить кубический сплайн (распечатать массивы \(a\), \(b\), \(c\), \(d\)).
    \item Вычислить значения \( f(x) \) в точках \( x_i^* = a + \left( i - \frac{1}{2} \right) h, \quad h = \frac{(b-a)}{n} \).
    \item Вычислить значения оригинальной функции и сплайна в произвольной точке, задаваемой с экрана.
\end{enumerate}

\textbf{Индивидуальный вариант (№4):} \( y = f(x) \) задана функцией: \( y = 2x * cos(x/2) \) на отрезке \([0, \pi]\).

\section{Основные теоретические сведения}

\subsection{Метод прогонки}
Метод прогонки применяется для решения систем линейных уравнений с трёхдиагональной матрицей коэффициентов. Такая система имеет вид:
\begin{equation}
    a_i x_{i-1} + b_i x_i + c_i x_{i+1} = f_i, \quad i = 1, 2, \dots, n,
\end{equation}
где $a_i, b_i, c_i$ – коэффициенты системы, а $f_i$ – правая часть.

Прямой ход:
на первом этапе метод прогонки преобразует систему к виду, удобному для последовательного нахождения неизвестных. Вводятся новые коэффициенты:
\begin{equation}
    \beta_i = \frac{c_i}{b_i - a_i \beta_{i-1}}, \quad i = 1, 2, \dots, n-1,
\end{equation}
\begin{equation}
    \phi_i = \frac{f_i - a_i \phi_{i-1}}{b_i - a_i \beta_{i-1}}, \quad i = 1, 2, \dots, n.
\end{equation}

Обратный ход:
после вычисления коэффициентов $\beta_i$ и $\phi_i$ производится обратный ход, на котором находятся неизвестные:
\begin{equation}
    x_n = \phi_n,
\end{equation}
\begin{equation}
    x_i = \phi_i - \beta_i x_{i+1}, \quad i = n-1, n-2, \dots, 1.
\end{equation}

Условия применимости:
метод прогонки применим, если выполнены условия:
\begin{equation}
    |b_i| > |a_i| + |c_i|, \quad \forall i.
\end{equation}

\subsection{Сплайн-интерполяция}
Интерполяционной функцией называется функция \( y = g(x) \), проходящая через заданные точки, называемые узлами интерполяции:  
\[
g(x_i) = f(x_i), \quad i = \overline{0, n}.
\]  
При этом в промежуточных точках равенство выполняется с некоторой погрешностью  
\[
g(x_i^*) \approx f(x_i^*).
\]  
Задача интерполяции заключается в поиске такой функции \( y = g(x) \).

Приближение функции кубическим сплайном — пример задачи интерполяции.


Сплайн \(k\)-го порядка — функция, проходящая через все узлы \((x_i, y_i)\),  
\(i = \overline{0, n}\), являющаяся многочленом \(k\)-ой степени на каждом частичном  
отрезке разбиения \([x_i, x_{i+1}]\), \(x_i = a + ih\), \(h = \frac{(b-a)}{n}\), \(x_i \in [a, b]\) и имеющая  
первые \(p\) непрерывных на \([a, b]\) производных.  
\(d = k - p\) — дефект сплайна. 

Наиболее употребительны сплайны третьего порядка с дефектом \(d = 1\) (кубические сплайны).  

На каждом частичном отрезке разбиения кубический сплайн описывается  
\[
S_i(x) = a_i + b_i(x - x_i) + c_i(x - x_i)^2 + d_i(x - x_i)^3
\]
\[
x \in [x_i, x_{i+1}], \quad i = \overline{0, n - 1}
\]

На частные многочлены накладываются условия:  

\begin{enumerate}
    \item Сплайн проходит через все узлы  
    \[
    S_i(x_i) = y_i, \quad i = \overline{0, n - 1}; \quad S_{n-1}(x_n) = y_n
    \]

    \item Условие гладкости на краях  
    \[
    S_0''(x_0) = 0; \quad S_{n-1}''(x_n) = 0
    \]

    \item Непрерывность сплайна и его первых двух производных в промежуточных узлах  
    \[
    S_{i-1}'(x_i) = S_i'(x_i);
    \]
    \[
    S_{i-1}''(x_i) = S_i''(x_i);
    \]
    \[
    i = \overline{0, n - 1}
    \]
\end{enumerate}

Эти условия позволяют выразить коэффициенты \(a_i, b_i, d_i\) и приводят к трехдиагональной СЛАУ относительно коэффициента \(c_i\):  
\[
a_i = y_i, \quad i = \overline{0, n - 1};
\]
\[
b_i = \frac{y_{i+1} - y_i}{h} - \frac{h}{3} (c_{i+1} + 2c_i), \quad i = \overline{0, n - 2};
\]
\[
b_{n-1} = \frac{y_{n-1} - y_{n-1}}{h} - \frac{2h}{3} c_{n-1};
\]
\[
d_i = \frac{c_{i+1} - c_i}{3h}, \quad i = \overline{0, n - 2};
\]
\[
d_{n-1} = -\frac{c_{n}}{3h}
\]

СЛАУ с трехдиагональной матрицей относительно коэффициента \(c_i\):  
\[
c_{i-1} + 4c_i + c_{i+1} = \frac{3(y_{i+1} - 2y_i + y_{i-1})}{h^2}, \quad i = \overline{1, n - 1};
\]
\[
c_0 = c_n = 0,
\]
где \(h = x_{i+1} - x_i\), \(i = \overline{0, n - 1}\) - постоянный шаг интерполяции.

\section{Реализация}


\lstinputlisting[language=go, caption=Метод прогонки]{code/lab0.go}

\lstinputlisting[language=go, caption=Сплайн-интерполяция]{code/lab1.go}

\section{Результаты}
Для заданных узлов интерполяции \((x_i, y_i)\) построен кубический
сплайн с коэффициентами, представленными в таблице 1.

\begin{table}[h!]
\centering
\caption{Коэффициенты кубического сплайна}
\begin{tabular}{|c|c|c|c|c|}
\hline
Интервал & \(a\) & \(b\) & \(c\) & \(d\) \\ \hline
[0.0000, 0.0982] & 0.0000 & 2.0000 & 0.0000 & -0.2499 \\ \hline
[0.0982, 0.1963] & 0.1961 & 1.9928 & -0.0736 & -0.2489 \\ \hline
[0.1963, 0.2945] & 0.3908 & 1.9711 & -0.1469 & -0.2469 \\ \hline
[0.2945, 0.3927] & 0.5827 & 1.9351 & -0.2196 & -0.2439 \\ \hline
[0.3927, 0.4909] & 0.7703 & 1.8850 & -0.2915 & -0.2399 \\ \hline
[0.4909, 0.5890] & 0.9523 & 1.8208 & -0.3621 & -0.2350 \\ \hline
[0.5890, 0.6872] & 1.1274 & 1.7429 & -0.4314 & -0.2291 \\ \hline
[0.6872, 0.7854] & 1.2941 & 1.6516 & -0.4988 & -0.2222 \\ \hline
[0.7854, 0.8836] & 1.4512 & 1.5472 & -0.5643 & -0.2145 \\ \hline
[0.8836, 0.9817] & 1.5975 & 1.4302 & -0.6275 & -0.2059 \\ \hline
[0.9817, 1.0799] & 1.7316 & 1.3010 & -0.6881 & -0.1964 \\ \hline
[1.0799, 1.1781] & 1.8526 & 1.1603 & -0.7459 & -0.1861 \\ \hline
[1.1781, 1.2763] & 1.9591 & 1.0084 & -0.8007 & -0.1750 \\ \hline
[1.2763, 1.3744] & 2.0502 & 0.8461 & -0.8523 & -0.1631 \\ \hline
[1.3744, 1.4726] & 2.1249 & 0.6741 & -0.9003 & -0.1506 \\ \hline
[1.4726, 1.5708] & 2.1823 & 0.4929 & -0.9447 & -0.1374 \\ \hline
[1.5708, 1.6690] & 2.2214 & 0.3035 & -0.9851 & -0.1235 \\ \hline
[1.6690, 1.7671] & 2.2416 & 0.1065 & -1.0215 & -0.1091 \\ \hline
[1.7671, 1.8653] & 2.2421 & -0.0972 & -1.0536 & -0.0942 \\ \hline
[1.8653, 1.9635] & 2.2223 & -0.3068 & -1.0814 & -0.0788 \\ \hline
[1.9635, 2.0617] & 2.1817 & -0.5214 & -1.1046 & -0.0629 \\ \hline
[2.0617, 2.1598] & 2.1198 & -0.7401 & -1.1231 & -0.0467 \\ \hline
[2.1598, 2.2580] & 2.0363 & -0.9620 & -1.1369 & -0.0301 \\ \hline
[2.2580, 2.3562] & 1.9309 & -1.1861 & -1.1457 & -0.0139 \\ \hline
[2.3562, 2.4544] & 1.8034 & -1.4115 & -1.1498 & 0.0052 \\ \hline
[2.4544, 2.5525] & 1.6537 & -1.6371 & -1.1483 & 0.0145 \\ \hline
[2.5525, 2.6507] & 1.4819 & -1.8621 & -1.1440 & 0.0608 \\ \hline
[2.6507, 2.7489] & 1.2881 & -2.0850 & -1.1261 & -0.0309 \\ \hline
[2.7489, 2.8471] & 1.0726 & -2.3070 & -1.1352 & 0.3925 \\ \hline
[2.8471, 2.9452] & 0.8355 & -2.5186 & -1.0196 & -1.1065 \\ \hline
[2.9452, 3.0434] & 0.5774 & -2.7508 & -1.3455 & 4.5684 \\ \hline
\end{tabular}
\end{table}




Значения функции и результаты интерполяции в точках \(x_i^*\) представлены в таблице 2.
\begin{table}[h!]
    \centering
    \caption{Значения функции и сплайна в точках \(x_i^*\)}
    \begin{tabular}{|c|c|c|c|c|}
    \hline
    \(i\) & \(x_i^*\) & \(f(x_i^*)\) & \(S(x_i^*)\) & Погрешность \\ \hline
    0 & -0.0490873852 & -0.0981452020 & -0.0981451946 & 0.0000000074 \\ \hline
    1 & 0.0490873852 & 0.0981452020 & 0.0981451946 & 0.0000000074 \\ \hline
    2 & 0.1472621556 & 0.2937262849 & 0.2937262626 & 0.0000000223 \\ \hline
    3 & 0.2454369261 & 0.4871822523 & 0.4871822153 & 0.0000000370 \\ \hline
    4 & 0.3436116965 & 0.6771058444 & 0.6771057928 & 0.0000000516 \\ \hline
    5 & 0.4417864669 & 0.8621039936 & 0.8621039275 & 0.0000000661 \\ \hline
    6 & 0.5399612373 & 1.0408034340 & 1.0408033537 & 0.0000000803 \\ \hline
    7 & 0.6381360078 & 1.2118562448 & 1.2118561506 & 0.0000000943 \\ \hline
    8 & 0.7363107782 & 1.3739453075 & 1.3739451996 & 0.0000001079 \\ \hline
    9 & 0.8344855486 & 1.5257896591 & 1.5257895379 & 0.0000001212 \\ \hline
    10 & 0.9326603190 & 1.6661497234 & 1.6661495894 & 0.0000001341 \\ \hline
    11 & 1.0308350895 & 1.7938324026 & 1.7938322561 & 0.0000001465 \\ \hline
    12 & 1.1290098599 & 1.9076960106 & 1.9076958522 & 0.0000001584 \\ \hline
    13 & 1.2271846303 & 2.0066550333 & 2.0066548636 & 0.0000001698 \\ \hline
    14 & 1.3253594007 & 2.0896846978 & 2.0896845172 & 0.0000001806 \\ \hline
    15 & 1.4235341712 & 2.1558253354 & 2.1558251446 & 0.0000001908 \\ \hline
    16 & 1.5217089416 & 2.2041865241 & 2.2041863238 & 0.0000002003 \\ \hline
    17 & 1.6198837120 & 2.2339509944 & 2.2339507852 & 0.0000002092 \\ \hline
    18 & 1.7180584824 & 2.2443782867 & 2.2443780694 & 0.0000002173 \\ \hline
    19 & 1.8162332529 & 2.2348081460 & 2.2348079212 & 0.0000002248 \\ \hline
    20 & 1.9144080233 & 2.2046636430 & 2.2046634122 & 0.0000002309 \\ \hline
    21 & 2.0125827937 & 2.1534540089 & 2.1534537700 & 0.0000002389 \\ \hline
    22 & 2.1107575641 & 2.0807771752 & 2.0807769395 & 0.0000002357 \\ \hline
    23 & 2.2089323346 & 1.9863220081 & 1.9863217375 & 0.0000002706 \\ \hline
    24 & 2.3071071050 & 1.8698702295 & 1.8698700705 & 0.0000001590 \\ \hline
    25 & 2.4052818754 & 1.7312980169 & 1.7312974264 & 0.0000005904 \\ \hline
    26 & 2.5034566458 & 1.5705772754 & 1.5705782844 & 0.0000010090 \\ \hline
    27 & 2.6016314163 & 1.3877765779 & 1.3877716111 & 0.0000049668 \\ \hline
    28 & 2.6998061867 & 1.1830617674 & 1.1830791003 & 0.0000173329 \\ \hline
    29 & 2.7979809571 & 0.9566962183 & 0.9566303294 & 0.0000658889 \\ \hline
    30 & 2.8961557275 & 0.7090407562 & 0.7092854614 & 0.0002447052 \\ \hline
    31 & 2.9943304980 & 0.4405532327 & 0.4396387955 & 0.0009144372 \\ \hline
    \end{tabular}
\end{table}


\section{Вывод}
В рамках лабораторной работы был исследован метод аппроксимации функции с использованием кубической сплайн-интерполяции. На основе заданных узлов интерполяции был построен сплайн третьего порядка, а также вычислены значения функции в серединах интервалов между узлами. В результате тестирования было установлено, что значения функции и сплайна полностью совпадают в узлах интерполяции, что подтверждает корректность метода. 
Таким образом, метод кубической сплайн-интерполяции демонстрирует высокую точность в узлах, но требует учета возможных неточностей в промежуточных точках.
\end{document}